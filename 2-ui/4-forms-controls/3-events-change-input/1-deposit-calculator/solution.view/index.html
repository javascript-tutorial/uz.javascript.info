<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <style>
      td select,
      td input {
        width: 150px;
      }

      #diagram td {
        vertical-align: bottom;
        text-align: center;
        padding: 10px;
      }

      #diagram div {
        margin: auto;
      }
    </style>
  </head>

  <body>
    <h1>Depozit kalkulyatori</h1>

    <form name="calculator">
      <table>
        <tr>
          <td><strong>Boshlang'ich depozit:</strong></td>
          <td>
            <input name="money" type="number" value="10000" required />
          </td>
        </tr>
        <tr>
          <td><strong>Necha oy?</strong></td>
          <td>
            <select name="months">
              <option value="3">3 (minimum)</option>
              <option value="6">6 (yarim yil)</option>
              <option value="12" selected>12 (bir yil)</option>
              <option value="18">18 (1,5 yil)</option>
              <option value="24">24 (2 yil)</option>
              <option value="30">30 (2,5 yil)</option>
              <option value="36">36 (3 yil)</option>
              <option value="60">60 (5 yil)</option>
            </select>
          </td>
        </tr>
        <tr>
          <td><strong>Yillik foiz stavkasi:</strong></td>
          <td>
            <input name="interest" type="number" value="5" required />
          </td>
        </tr>
      </table>
    </form>

    <div class="calculation-result">
      <table id="diagram">
        <tr>
          <th>Edi:</th>
          <th>Bo'ladi:</th>
        </tr>
        <tr>
          <th id="money-before">10000</th>
          <th id="money-after">10000</th>
        </tr>
        <tr>
          <td>
            <div class="bar-container">
              <div
                style="
                  background: #dc3545;
                  width: 40px;
                  height: 100px;
                  border-radius: 4px;
                "
              ></div>
            </div>
          </td>
          <td>
            <div class="bar-container">
              <div
                style="
                  background: #28a745;
                  width: 40px;
                  height: 100px;
                  border-radius: 4px;
                "
                id="height-after"
              ></div>
            </div>
          </td>
        </tr>
      </table>
    </div>

    <script>
      let form = document.forms.calculator;

      form.money.oninput = calculate;
      form.months.onchange = calculate;
      form.interest.oninput = calculate;

      function calculate() {
        let initial = +form.money.value;
        if (!initial) return;

        let interest = form.interest.value * 0.01;
        if (!interest) return;

        let years = form.months.value / 12;
        if (!years) return;

        // Oddiy foiz hisobi (murakkab foiz o'rniga)
        let result = Math.round(initial * (1 + interest * years));

        // Diagramma balandligini hisoblash
        let heightRatio = result / initial;
        let height = Math.min(heightRatio * 100, 200) + "px"; // Maksimal balandlikni cheklash

        document.getElementById("height-after").style.height = height;
        document.getElementById("money-before").innerHTML =
          formatMoney(initial);
        document.getElementById("money-after").innerHTML = formatMoney(result);
      }

      // Pulni formatlash funksiyasi
      function formatMoney(amount) {
        return new Intl.NumberFormat("uz-UZ").format(amount) + " so'm";
      }

      // Boshlang'ich hisoblash
      calculate();
    </script>
  </body>
</html>
