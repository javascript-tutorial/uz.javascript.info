<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
  </head>
  <body>
    <script>
      function preloadImages(sources, callback) {
        let counter = 0;

        function onLoad() {
          counter++;
          if (counter == sources.length) callback();
        }

        for (let source of sources) {
          let img = document.createElement("img");
          img.onload = img.onerror = onLoad;
          img.src = source;
        }
      }

      // ---------- The test ----------

      let sources = [
        "https://en.js.cx/images-load/1.jpg",
        "https://en.js.cx/images-load/2.jpg",
        "https://en.js.cx/images-load/3.jpg",
      ];

      // brauzer keshini oldini olish uchun tasodifiy belgilar qo'shing
      for (let i = 0; i < sources.length; i++) {
        sources[i] += "?" + Math.random();
      }

      // har bir rasm uchun,
      // Keling, xuddi shu src bilan boshqa img yarataylik va uning kengligi borligini tekshiramiz
      function testLoaded() {
        let widthSum = 0;
        for (let i = 0; i < sources.length; i++) {
          let img = document.createElement("img");
          img.src = sources[i];
          widthSum += img.width;
        }
        alert(widthSum);
      }

      // 300 chiqishi kerak
      preloadImages(sources, testLoaded);
    </script>
  </body>
</html>
